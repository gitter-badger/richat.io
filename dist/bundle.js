!function e(t,s,r){function n(a,c){if(!s[a]){if(!t[a]){var o="function"==typeof require&&require;if(!c&&o)return o(a,!0);if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var h=s[a]={exports:{}};t[a][0].call(h.exports,function(e){var s=t[a][1][e];return n(s?s:e)},h,h.exports,e,t,s,r)}return s[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)n(r[a]);return n}({1:[function(e,t,s){"use strict";var r=e("./partials/header"),n=e("./partials/userList"),i=e("./partials/messageBox"),a=React.createClass({displayName:"Page",render:function(){return React.createElement("div",{className:"app"},React.createElement(r,null),React.createElement(n,null),React.createElement(i,null))}});React.render(React.createElement(a,null),document.body)},{"./partials/header":10,"./partials/messageBox":11,"./partials/userList":12}],2:[function(e,t,s){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function i(e){return"number"==typeof e}function a(e){return"object"==typeof e&&null!==e}function c(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!i(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,s,r,i,o,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(s=this._events[e],c(s))return!1;if(n(s))switch(arguments.length){case 1:s.call(this);break;case 2:s.call(this,arguments[1]);break;case 3:s.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,i=new Array(r-1),o=1;r>o;o++)i[o-1]=arguments[o];s.apply(this,i)}else if(a(s)){for(r=arguments.length,i=new Array(r-1),o=1;r>o;o++)i[o-1]=arguments[o];for(l=s.slice(),r=l.length,o=0;r>o;o++)l[o].apply(this,i)}return!0},r.prototype.addListener=function(e,t){var s;if(!n(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned){var s;s=c(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,s&&s>0&&this._events[e].length>s&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function s(){this.removeListener(e,s),r||(r=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var r=!1;return s.listener=t,this.on(e,s),this},r.prototype.removeListener=function(e,t){var s,r,i,c;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(s=this._events[e],i=s.length,r=-1,s===t||n(s.listener)&&s.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(s)){for(c=i;c-->0;)if(s[c]===t||s[c].listener&&s[c].listener===t){r=c;break}if(0>r)return this;1===s.length?(s.length=0,delete this._events[e]):s.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,s;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(s=this._events[e],n(s))this.removeListener(e,s);else for(;s.length;)this.removeListener(e,s[s.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.listenerCount=function(e,t){var s;return s=e._events&&e._events[t]?n(e._events[t])?1:e._events[t].length:0}},{}],3:[function(e,t,s){t.exports.Dispatcher=e("./lib/Dispatcher")},{"./lib/Dispatcher":4}],4:[function(e,t,s){"use strict";function r(){this.$Dispatcher_callbacks={},this.$Dispatcher_isPending={},this.$Dispatcher_isHandled={},this.$Dispatcher_isDispatching=!1,this.$Dispatcher_pendingPayload=null}var n=e("./invariant"),i=1,a="ID_";r.prototype.register=function(e){var t=a+i++;return this.$Dispatcher_callbacks[t]=e,t},r.prototype.unregister=function(e){n(this.$Dispatcher_callbacks[e],"Dispatcher.unregister(...): `%s` does not map to a registered callback.",e),delete this.$Dispatcher_callbacks[e]},r.prototype.waitFor=function(e){n(this.$Dispatcher_isDispatching,"Dispatcher.waitFor(...): Must be invoked while dispatching.");for(var t=0;t<e.length;t++){var s=e[t];this.$Dispatcher_isPending[s]?n(this.$Dispatcher_isHandled[s],"Dispatcher.waitFor(...): Circular dependency detected while waiting for `%s`.",s):(n(this.$Dispatcher_callbacks[s],"Dispatcher.waitFor(...): `%s` does not map to a registered callback.",s),this.$Dispatcher_invokeCallback(s))}},r.prototype.dispatch=function(e){n(!this.$Dispatcher_isDispatching,"Dispatch.dispatch(...): Cannot dispatch in the middle of a dispatch."),this.$Dispatcher_startDispatching(e);try{for(var t in this.$Dispatcher_callbacks)this.$Dispatcher_isPending[t]||this.$Dispatcher_invokeCallback(t)}finally{this.$Dispatcher_stopDispatching()}},r.prototype.isDispatching=function(){return this.$Dispatcher_isDispatching},r.prototype.$Dispatcher_invokeCallback=function(e){this.$Dispatcher_isPending[e]=!0,this.$Dispatcher_callbacks[e](this.$Dispatcher_pendingPayload),this.$Dispatcher_isHandled[e]=!0},r.prototype.$Dispatcher_startDispatching=function(e){for(var t in this.$Dispatcher_callbacks)this.$Dispatcher_isPending[t]=!1,this.$Dispatcher_isHandled[t]=!1;this.$Dispatcher_pendingPayload=e,this.$Dispatcher_isDispatching=!0},r.prototype.$Dispatcher_stopDispatching=function(){this.$Dispatcher_pendingPayload=null,this.$Dispatcher_isDispatching=!1},t.exports=r},{"./invariant":5}],5:[function(e,t,s){"use strict";var r=function(e,t,s,r,n,i,a,c){if(!e){var o;if(void 0===t)o=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[s,r,n,i,a,c],h=0;o=new Error("Invariant Violation: "+t.replace(/%s/g,function(){return l[h++]}))}throw o.framesToPop=1,o}};t.exports=r},{}],6:[function(e,t,s){"use strict";function r(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}t.exports=Object.assign||function(e,t){for(var s,n,i=r(e),a=1;a<arguments.length;a++){s=arguments[a],n=Object.keys(Object(s));for(var c=0;c<n.length;c++)i[n[c]]=s[n[c]]}return i}},{}],7:[function(e,t,s){"use strict";var r=e("../dispatchers/app"),n={changeOpenChat:function(e){r.handleViewAction({type:"updateOpenChatID",userID:e})}};t.exports=n},{"../dispatchers/app":9}],8:[function(e,t,s){"use strict";var r=React.createClass({displayName:"ReplyBox",render:function(){return React.createElement("div",{className:"reply-box"},React.createElement("input",{className:"reply-box__input",placeholder:"Type message to reply.."}),React.createElement("span",{className:"reply-box__tip"},"Press ",React.createElement("span",{className:"reply-box__tip__button"},"Enter")," to send"))}});t.exports=r},{}],9:[function(e,t,s){"use strict";var r=e("flux").Dispatcher,n=e("object-assign"),i=n(new r,{handleServerAction:function(e){this.dispatch({source:"server",action:e})},handleViewAction:function(e){this.dispatch({source:"view",action:e})}});t.exports=i},{flux:3,"object-assign":6}],10:[function(e,t,s){"use strict";var r=React.createClass({displayName:"Header",render:function(){return React.createElement("header",{className:"header"})}});t.exports=r},{}],11:[function(e,t,s){"use strict";function r(){return i.getChatByUserID(i.getOpenChatUserID())}var n=e("../components/replyBox"),i=e("../stores/messages"),a=e("../stores/user"),c=e("../utils"),o=React.createClass({displayName:"MessageBox",getInitialState:function(){return r()},componentWillMount:function(){i.addChangeListener(this.onStoreChange)},componentWillUnmount:function(){i.removeChangeListener(this.onStoreChange)},onStoreChange:function(){this.setState(r())},render:function(){var e=this.state.messages.length,t=a.user.id,s=this.state.messages.map(function(e,s){var r=React.addons.classSet({"message-box__item":!0,"message-box__item--from-current":e.from===t,clear:!0});return React.createElement("li",{key:e.timestamp+"-"+e.from,className:r},React.createElement("div",{className:"message-box__item__contents"},e.contents))}),r=this.state.messages[e-1];if(r.from===t&&this.state.lastAccess.recipient>=r.timestamp){var i=c.getShortDate(r.timestamp);s.push(React.createElement("li",{key:"read",className:"message-box__item message-box__item--read"},React.createElement("div",{className:"message-box__item__contents"},"Read ",i)))}return React.createElement("div",{className:"message-box"},React.createElement("ul",{className:"message-box__list"},s),React.createElement(n,null))}});t.exports=o},{"../components/replyBox":8,"../stores/messages":13,"../stores/user":14,"../utils":15}],12:[function(e,t,s){"use strict";function r(){var e=i.getAllChats(),t=[];for(var s in e){var r=e[s],n=r.messages.length;t.push({lastMessage:r.messages[n-1],lastAccess:r.lastAccess,user:r.user})}return{openChatID:i.getOpenChatUserID(),messageList:t}}var n=e("../utils"),i=e("../stores/messages"),a=e("../actions/messages"),c=e("../stores/user"),o=React.createClass({displayName:"UserList",getInitialState:function(){return r()},componentWillMount:function(){i.addChangeListener(this.onStoreChange)},componentWillUnmount:function(){i.removeChangeListener(this.onStoreChange)},onStoreChange:function(){this.setState(r())},changeOpenChat:function(e){a.changeOpenChat(e)},render:function(){this.state.messageList.sort(function(e,t){return e.lastMessage.timestamp>t.lastMessage.timestamp?-1:e.lastMessage.timestamp<t.lastMessage.timestamp?1:0});var e=this.state.messageList.map(function(e,t){var s,r=n.getNiceDate(e.lastMessage.timestamp);e.lastMessage.from!==e.user.id&&(s=React.createElement("i",{className:"fa fa-reply user-list__item__icon"})),e.lastAccess.currentUser<e.lastMessage.timestamp&&(s=React.createElement("i",{className:"fa fa-circle user-list__item__icon"}));var i=!1;e.lastAccess.currentUser<e.lastMessage.timestamp&&(i=e.lastMessage.from!==c.user.id);var a=React.addons.classSet({"user-list__item":!0,clear:!0,"user-list__item--new":i,"user-list__item--active":this.state.openChatID===e.user.id});return React.createElement("li",{onClick:this.changeOpenChat.bind(this,e.user.id),className:a,key:e.user.id},React.createElement("div",{className:"user-list__item__picture"},React.createElement("img",{src:e.user.profilePicture})),React.createElement("div",{className:"user-list__item__details"},React.createElement("h4",{className:"user-list__item__name"},e.user.name,React.createElement("abbr",{className:"user-list__item__timestamp"},r)),React.createElement("span",{className:"user-list__item__message"},s," ",e.lastMessage.contents)))},this);return React.createElement("div",{className:"user-list"},React.createElement("ul",{className:"user-list__list"},e))}});t.exports=o},{"../actions/messages":7,"../stores/messages":13,"../stores/user":14,"../utils":15}],13:[function(e,t,s){"use strict";var r=e("../dispatchers/app"),n=e("events").EventEmitter,i=e("object-assign"),a={1:{user:{profilePicture:"https://avatars0.githubusercontent.com/u/7922109?v=3&s=460",id:1,name:"Ryan Clark",status:"online"},lastAccess:{recipient:1424469794050,currentUser:1424469794080},messages:[{contents:"Hey!",from:2,timestamp:1424469793023},{contents:"HeyHo!",from:2,timestamp:1424469793024},{contents:"Hey, what's up?",from:1,timestamp:1424469794e3},{contents:"YUNO?",from:2,timestamp:1424469795e3},{contents:"WORK?",from:1,timestamp:1424469796e3}]},2:{user:{profilePicture:"https://avatars3.githubusercontent.com/u/678772?v=3&s=200",id:2,name:"Richard Hoffmann",status:"online"},lastAccess:{recipient:1424469794050,currentUser:1424469794080},messages:[{contents:"Hey!",from:2,timestamp:1424469793023},{contents:"YUNO?",from:2,timestamp:1424469795e3},{contents:"WORK?",from:1,timestamp:1424469796e3}]}},c=parseInt(Object.keys(a)[0],10),o=i({},n.prototype,{addChangeListener:function(e){this.on("change",e)},removeChangeListener:function(e){this.off("change",e)},getOpenChatUserID:function(){return c},getChatByUserID:function(e){return a[e]},getAllChats:function(){return a}});o.dispatchToken=r.register(function(e){var t={updateOpenChatID:function(e){c=e.action.userID,o.emit("change")}};t[e.action.type]&&t[e.action.type](e)}),t.exports=o},{"../dispatchers/app":9,events:2,"object-assign":6}],14:[function(e,t,s){"use strict";var r={user:{id:1,name:"John Doe",profilePicture:"https://avatars1.githubusercontent.com/u/8901351?v=3&s=200"}};t.exports=r},{}],15:[function(e,t,s){"use strict";var r={getShortDate:function(e){var t=Math.round((+new Date-e)/6e4),s=new Date(e),r=("0"+s.getHours()).slice(-2),n=("0"+s.getMinutes()).slice(-2);return t>2879?t>14567?this.getNiceDate(e):"Yesterday at "+r+":"+n:"at "+r+":"+n},getNiceDate:function(e){var t,s="%d %f%y at %h:%i",r={0:"less than a minute ago",1:"1 minute ago",59:"%distance minutes ago",118:"an hour ago",1439:"%r hours ago",2879:"Yesterday at %h:%i",14567:"%l at %h:%i"},n=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i=["January","February","March","April","May","June","July","August","September","October","November","December"],a=new Date(e),c=Math.round((+new Date-e)/6e4);for(var o in r)if(o>c){t=r[o];break}var l=("0"+a.getHours()).slice(-2),h=("0"+a.getMinutes()).slice(-2),u=n[a.getDay()],p=i[a.getMonth()],m=a.getFullYear();if((new Date).getFullYear()===m&&(m=""),t){var f=Math.round(c/60);return t.replace(/%distance/i,c).replace(/%r/i,f).replace(/%h/i,l).replace(/%i/i,h).replace(/%l/i,u)}return s.replace(/%d/i,u).replace(/%f/i,p).replace(/%y/i,m).replace(/%h/i,l).replace(/%i/i,h)}};t.exports=r},{}]},{},[1]);
//# sourceMappingURL=bundle.js.map